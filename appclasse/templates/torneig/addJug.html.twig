{% extends 'base.html.twig' %}

{% block title %}Afegir Jugadors{% endblock %}
{% block style %}
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css">
    <script src="//cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
{% endblock %}
{% block body %}


    <script>
        $(document).ready( function () {
            $('#tables').DataTable();
        })
    </script>

    <h1 class="has-text-centered is-size-3 m-5 has-text-weight-bold">Afageix i Elimina usuaris del torneig <span class="is-size-3 is-family-code has-text-primary has-text-weight-bold">{{ torneig.nom }}</span></h1>
    <div class="is-flex is-justify-content-center"style="width: 100%;"  >
        <div class="is-flex is-justify-content-space-between" style="width: 50%;" >
            {% if not torneig.nom %}
                <form method="post" action="{{ path('torneig_delete', {'id': torneig.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
                    <input type="hidden" name="_method" value="DELETE">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ torneig.id) }}">
                    <button class="button is-danger is-light" style="border-color:red;">Cancelar</button>
                </form>
                <a class="button is-success is-light" href="{{ path('torneig_edit', {'id': torneig.id}) }}"  style="border-color:green;">Continuar</a>
            {% endif %}
        </div>
    </div>

    <div class="is-flex is-justify-content-center mt-5">

    <div style="width: 50%">
        <table class="table " id="tables" >
            <thead>
            <tr>
                <th>Nom Jugador</th>
                <th>Codi Fide</th>
                <th>Elo Fide</th>
                <th>Pais</th>
                <th> {{ torneig.theParticipants|length }}</th>
            </tr>
            </thead>

            <tbody>
            {% for jugador in jugadors %}

                <tr>
                    <td>{{ jugador.nom }}</td>
                    <td>{{ jugador.codiFide }}</td>
                    <td>{{ jugador.elo }}</td>
                    <td>{{ jugador.pais }}</td>
                    {% set alreadyIn = false %}
                    {% for theplay in jugadorsInTournament %}
                        {%if theplay.nom  == jugador.nom %}
                            {% set alreadyIn = true %}
                        {% endif %}
                    {% endfor %}
                    {% if alreadyIn == true %}
                        <td>
                            <form {{ path('torneig_addJugadors',{'id': torneig.id}) }} method="post">
                                <input type="hidden" value="delete" name="action">
                                <input type="hidden" value="{{ jugador.id }}" name="idJug">
                                <button id="idBut"class="button is-danger is-small" onclick="changeButtonState(this)">Elimina</button>
                            </form>
                        </td>
                    {% else  %}
                        <td>
                            <form {{ path('torneig_addJugadors',{'id': torneig.id}) }} method="post">
                                <input type="hidden" value="add" name="action">
                                <input type="hidden" value="{{ jugador.id }}" name="idJug">
                                <button id="idBut"class="button is-success is-small" onclick="changeButtonState(this)">Afageix</button>
                            </form>
                        </td>
                    {% endif %}
                </tr>

            {% else %}

                <tr>
                    <td colspan="6">no records found</td>
                </tr>
            {% endfor %}
            </tbody>


        </table>
    </div>

</div>



    <script>
        function changeButtonState(button){
            button.addClass('is-loading').reload;

            $('#idBut').load(self)

        }

    </script>
{% endblock %}

